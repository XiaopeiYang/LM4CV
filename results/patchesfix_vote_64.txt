{'dataset': 'fungi_small', 'attributes': 'fungi_small', 'cluster_feature_method': 'linear', 'model_type': 'clip', 'model_size': 'ViT-B/32', 'mahalanobis': True, 'division_power': 2, 'linear_epochs': 132, 'reinit': True, 'num_attributes': 64, 'seed': 0, 'lr': 0.001, 'batch_size': 28, 'epochs': 1050, 'linear_model': ['linear', 'linear'], 'score_model': ['linear'], 'json_file': '/export/home/ra79nod/proj/LM4CV/data/fungi_small/split_zhou_FungiSmall.json', 'ROOT': '/export/group/datasets/microbiology/images_png'}
num_attributes:  64
600 images for training.
600 images for testing.
mahalanobis:
Epoch [0], Best accuracy: 22.666667938232422, Last accuracy: 22.666667938232422
Epoch [10], Best accuracy: 81.33333587646484, Last accuracy: 70.5
Epoch [20], Best accuracy: 81.33333587646484, Last accuracy: 77.0
selected_attributions: ['thin, flat plates with smooth edges', 'appear as a uniform, dark-stained colonies', 'branching, tree-like structures with thickened tips', 'cell membranes are thin and continuous', 'no visible flagella or appendages', 'uniform in size and shape', 'extremely short to non-existent, no branching events, straight', 'fine, delicate threads with intricate branching', 'appear as uniform, dark-stained colonies', 'mycelium growth, branching structures, no compound effect', 'swelling star phenotype, swelling spores with several germination tubes around', 'tubes look like a line of pebbles along a necklace, short, thicker than usual', 'curly germination phenotype, chaotic germination tube growth', 'randomly arranged, chaotic clusters of filaments', 'small, round yeast cells with dark centers', 'small, round or oval-shaped organisms', 'several tubes per spore, tubes distribution and growth is chaotic, tubes tend to create agglomerates around the spore', 'thick, dense networks with numerous nodes', 'round, small, of rather uniform size and shape', 'size: 0.5-1.5 Î¼m in length', 'swirling patterns of thin, wispy filaments', 'rather isolated, with a clear tendency to form clusters', 'needle-like crystals with irregularly shaped tips', 'irregularly shaped, budding yeast cells', 'irregularly shaped, budding yeast cells with dark edges', 'thin, rod-shaped yeast cells', 'appear as a uniform, featureless background', 'swelling, round, larger than usual', 'gram-positive, stain dark blue', 'needle-like crystals with curved surfaces', 'thin, rod-shaped bacteria', 'branching, filamentous structures', 'web-like structures with interconnected nodes', 'appear as a cloudy or hazy mass', 'large, irregularly shaped yeast cells with dark edges', 'show little to no contrast', 'appear as single cells or pairs', 'no visible staining or pigmentation', 'extremely long, with several branching events, growing rather linearly with possibly some irregular curly patterns', 'needle-like crystals with sharp edges', 'curly, with several branching events, short', 'thin, delicate filaments with nodes', 'all tubes branch, overlap and connect, growing very far out of their original spore, creating a branching structure with rather stable density across the whole image', 'short, can have more than one branching event, can be either straight or curly', 'pearl necklace phenotype, germination tubes look like pebbles', 'lack of defined boundaries', 'clumped, round yeast cells with dark centers', 'round, large', 'clumped masses with irregular borders', 'irregularly shaped crystals with smooth surfaces', 'small and round, often hard to detect because covered by branching tubes', 'appear as tiny dots or specks', 'no distinctive staining patterns', 'no visible organelles or structures', 'needle-like crystals with pointed tips', 'thin, flat plates with irregularly shaped crystals', 'cell contents are homogeneous', 'zero to one tube per spore', 'thick, irregularly shaped yeast cells', 'swelling spores of different shapes, from round to ovoidal, irregular distribution of germination tubes', 'no visible movement or activity', 'cell walls thin, transparent', 'no significant differences in cell shape', 'spores exist only as a part of a very large overlapping branching structure']
/export/home/ra79nod/proj/LM4CV/cluster.py:125: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return best_acc, best_model, [attributes[i] for i in selected_idxes], torch.tensor(attribute_embeddings[selected_idxes])
cfg['reinit']  and cfg['num_attributes'] != 'full'
600 images for training.
600 images for testing.
Epoch [0], Best accuracy: 16.666667938232422, Last accuracy: 16.666667938232422
Epoch [10], Best accuracy: 45.5, Last accuracy: 21.66666603088379
Epoch [20], Best accuracy: 48.0, Last accuracy: 48.0
Epoch [30], Best accuracy: 56.16666793823242, Last accuracy: 38.166664123535156
Epoch [40], Best accuracy: 60.000003814697266, Last accuracy: 52.0
Epoch [50], Best accuracy: 65.83333587646484, Last accuracy: 65.83333587646484
Epoch [60], Best accuracy: 69.33333587646484, Last accuracy: 53.16666793823242
Epoch [70], Best accuracy: 70.33332824707031, Last accuracy: 70.33332824707031
Epoch [80], Best accuracy: 70.33332824707031, Last accuracy: 56.33333206176758